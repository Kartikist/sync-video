<!DOCTYPE html>
<html>
<head>
  <title>Sync Video</title>
</head>
<body>
  <div>
    <input type="text" id="youtube-link" placeholder="Enter YouTube video link here" />
    <button id="load-video" onclick="loadVideo()">Load Video</button>
  </div>
  <div>
    <div id="player"></div>
  </div>
  <script>
    var player;
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        events: {
          'onReady': onPlayerReady
        }
      });
    }

    function onPlayerReady(event) {
      // Sync playback for multiple users
      var timestamp = Date.now();
      var syncUrl = 'https://localhost:3000/sync?t=' + timestamp;
      fetch(syncUrl)
        .then(function(response) {
          return response.text();
        })
        .then(function(data) {
          var syncData = JSON.parse(data);
          var currentTime = syncData.currentTime;
          player.seekTo(currentTime, true);
          setInterval(function() {
            var currentTime = player.getCurrentTime();
            fetch(syncUrl, {
              method: 'POST',
              body: JSON.stringify({ currentTime: currentTime }),
              headers: {
                'Content-Type': 'application/json'
              }
            });
          }, 1000);
        });
    }
    function loadVideo(){
        var link = document.getElementById("youtube-link").value;
        var videoId = link.split('v=')[1];
        var ampersandPosition = videoId.indexOf('&');
        if(ampersandPosition !== -1) {
            videoId = videoId.substring(0, ampersandPosition);
        }
        player.loadVideoById(videoId);
    }
  </script>
  <script src="https://www.youtube.com/iframe_api"></script>
</body>
</html>
